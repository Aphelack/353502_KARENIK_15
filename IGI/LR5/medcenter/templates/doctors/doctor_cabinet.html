{% extends "base.html" %}
{% block content %}
<div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>–ö–∞–±–∏–Ω–µ—Ç –≤—Ä–∞—á–∞</h2>
        <a href="{% url 'statistics' %}" style="padding: 10px 20px; background: #2c3e50; color: white; text-decoration: none; border-radius: 4px;">
            üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∞–π—Ç–∞
        </a>
    </div>
    <div style="border: 1px solid #ddd; padding: 20px; margin-bottom: 20px;">
        <h5>–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h5>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}!</p>
        <ul style="list-style: none; padding: 0;">
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–ò–º—è: {{ user.first_name|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–§–∞–º–∏–ª–∏—è: {{ user.last_name|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–¢–µ–ª–µ—Ñ–æ–Ω: {{ user_profile.phone|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–ê–¥—Ä–µ—Å: {{ user_profile.address|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {{ user_profile.birth_date|date:"d.m.Y"|default:"-" }}</li>
            {% if doctor %}
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: {{ doctor.specialization|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ doctor.category|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã: {{ doctor.experience_years }} –ª–µ—Ç</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">–°—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏: {{ doctor.consultation_price }} BYN</li>
            {% endif %}
        </ul>
    </div>

    <div style="border: 1px solid #ddd; padding: 20px; margin-bottom: 20px;">
        <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h3>
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #2c3e50; color: white;">
                        <th style="padding: 10px; text-align: left;">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</th>
                        <th style="padding: 10px; text-align: left;">–ü–∞—Ü–∏–µ–Ω—Ç</th>
                        <th style="padding: 10px; text-align: left;">–£—Å–ª—É–≥–∞</th>
                        <th style="padding: 10px; text-align: left;">–ó–∞–º–µ—Ç–∫–∏</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app in appointments %}
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 10px;">{{ app.appointment_date|date:"d.m.Y H:i" }}</td>
                        <td style="padding: 10px;">
                            {% if app.client %}
                                <a href="{% url 'client_detail' app.client.id %}">
                                    {{ app.client.full_name }}
                                </a>
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td style="padding: 10px;">{{ app.service.name }}</td>
                        <td style="padding: 10px;">{{ app.notes|default:"-" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" style="padding: 20px; text-align: center;">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    {% if doctor %}
    <div style="border: 1px solid #ddd; padding: 20px; margin-bottom: 20px;">
        <h3>–û–∫–∞–∑—ã–≤–∞–µ–º—ã–µ —É—Å–ª—É–≥–∏</h3>
        <ul style="list-style: none; padding: 0;">
            {% for service in doctor.services.all %}
                <li style="padding: 10px; border-bottom: 1px solid #eee;">{{ service.name }} ‚Äî {{ service.price }} BYN</li>
            {% empty %}
                <li style="padding: 10px;">–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥</li>
            {% endfor %}
        </ul>

        <h4 style="margin-top: 20px;">–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</h4>
        <form method="post">
            {% csrf_token %}
            <div style="display: flex; gap: 10px;">
                <select name="service_id" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" required>
                    <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É...</option>
                    {% for service in available_services %}
                        <option value="{{ service.id }}">{{ service.name }} ‚Äî {{ service.price }} BYN</option>
                    {% endfor %}
                </select>
                <button type="submit" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
            </div>
        </form>
    </div>
    {% endif %}

    <div>
        <a href="{% url 'account_logout' %}" style="display: inline-block; padding: 10px 20px; background: #dc3545; color: white; text-decoration: none; border-radius: 4px;">
            –í—ã–π—Ç–∏
        </a>
    </div>
</div>
{% endblock %}