{% extends "base.html" %}
{% block content %}
<div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
    <h2>Кабинет клиента</h2>
    <div style="border: 1px solid #ddd; padding: 20px; margin-bottom: 20px;">
        <h5>Личная информация</h5>
        <p>Добро пожаловать, {{ user.username }}!</p>
        <ul style="list-style: none; padding: 0;">
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Имя: {{ user.first_name|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Фамилия: {{ user.last_name|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Адрес: {{ user_profile.address|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Дата рождения: {{ user_profile.birth_date|date:"d.m.Y"|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Логин: {{ user.username }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Email: {{ user.email }}</li>
            {% if client %}
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Номер медицинской карты: {{ client.medical_card_number|default:"-" }}</li>
            <li style="padding: 10px; border-bottom: 1px solid #eee;">Предпочитаемый язык: {{ client.preferred_language }}</li>
            {% endif %}
        </ul>
    </div>

    <div style="border: 1px solid #ddd; padding: 20px;">
        <h3>Ваши записи</h3>
        
        {% if messages %}
            {% for message in messages %}
                <div style="padding: 15px; margin: 10px 0; background: #d4edda; border: 1px solid #c3e6cb; color: #155724;">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #2c3e50; color: white;">
                        <th style="padding: 10px; text-align: left;">Дата и время</th>
                        <th style="padding: 10px; text-align: left;">Врач</th>
                        <th style="padding: 10px; text-align: left;">Услуга</th>
                        <th style="padding: 10px; text-align: left;">Заметки</th>
                        <th style="padding: 10px; text-align: left;">Действия</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app in appointments %}
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 10px;">{{ app.appointment_date|date:"d.m.Y H:i" }}</td>
                        <td style="padding: 10px;">
                            {% if app.doctor %}
                                <a href="{% url 'doctor_detail' app.doctor.id %}">
                                    {{ app.doctor.full_name }}
                                </a>
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td style="padding: 10px;">{{ app.service.name }}</td>
                        <td style="padding: 10px;">{{ app.notes|default:"-" }}</td>
                        <td style="padding: 10px;">
                            <a href="{% url 'edit_appointment' app.id %}" style="display: inline-block; padding: 5px 10px; background: #ffc107; color: #000; text-decoration: none; margin-right: 5px;">
                                Изменить
                            </a>
                            <a href="{% url 'delete_appointment' app.id %}" style="display: inline-block; padding: 5px 10px; background: #dc3545; color: white; text-decoration: none;">
                                Удалить
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" style="padding: 20px; text-align: center;">Нет записей</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div style="margin-top: 20px;">
            <a href="{% url 'service_list' %}" style="display: inline-block; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 4px;">
                Записаться на новую услугу
            </a>
            <a href="{% url 'account_logout' %}" style="display: inline-block; padding: 10px 20px; background: #dc3545; color: white; text-decoration: none; border-radius: 4px; float: right;">
                Выйти
            </a>
        </div>
    </div>
</div>
{% endblock %}